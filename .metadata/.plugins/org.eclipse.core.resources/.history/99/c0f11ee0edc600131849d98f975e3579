<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="jxau.sms.advanceinfo.dao"><!-- namespace必须是与接口的包路径一致，不然会报错误 -->

    <!--<cache eviction="FIFO" flushInterval="60000" size="512" readOnly="true" /> --><!-- Mybaties内置二级缓存 -->
    
    <!-- 使用第三方缓存插件实现二级缓存 -->
    
   	<resultMap type="StuAdvInfo" id="listStuAdvInfo"><!-- 查询返回集合类型的配置 -->
        <id column="awardNo" property="awardNo" />
        <result column="studentNo" property="studentNo" />
        <result column="advanceActivity" property="advanceActivity" />
        <result column="advLevel" property="advLevel" />
        <result column="advTime" property="advTime" />
        <result column="examState" property="examState" />
        <result column="remarks" property="remarks" />
 	</resultMap>
 	
 	<resultMap type="StuAdvVo" id="listStuAdvVo"><!-- 查询返回集合类型的配置 -->
        <result column="studentNo" property="studentNo" />
        <result column="studentName" property="studentName" />
        <result column="sex" property="sex" />
        <result column="college" property="college" />
        <result column="major" property="major" />
        <result column="className" property="className" />
        <result column="advanceActivity" property="advanceActivity" />
        <result column="advLevel" property="advLevel" />
        <result column="advTime" property="advTime" />
        <result column="examState" property="examState" />
        <result column="remarks" property="remarks" />
 	</resultMap>

    <select id="findAdvInfoById" parameterType="java.util.Map"  resultMap="listStuAdvVo">
		<!-- {call adv_info_proc(#{studentNo})}
		select * from stu_adv_info sav where sav.studentNo = #{studentNo}
		--> <!--使用存储过程--> 
		 select sb.studentNo,sb.studentName,sb.sex,sb.college,sb.major,sb.className,sa.advanceActivity,sa.advTime,sa.advLevel,sa.examState,sa.remarks
	   from stu_basic_info sb inner join stu_adv_info sa on sb.studentNo = sa.studentNo where sb.studentNo = #{studentNo};
    </select>
    
    <select id="findAdvInfoByLevel" parameterType="java.util.Map" statementType="CALLABLE" resultType="int">
		{call adv_numbers_proc(#{advLevel,jdbcType=String,mode=IN},  
    						   #{numbers,jdbcType=INTEGER,mode=OUT}} <!--使用存储过程--> 
    </select>
     <select id="insertAdvInfo" parameterType="java.util.Map" statementType="CALLABLE" resultType="int">
		insert into stu_adv_info values();
    </select>
</mapper>
